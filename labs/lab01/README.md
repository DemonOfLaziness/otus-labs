# Развертывание коммутируемой сети с резервными каналами
 
 Топология сети для данной работы:

![](netTopology.png)

Таблица адресов:

![](addrTable.png)

Цели
- [Часть 1:	Создание сети и настройка основных параметров устройства](#часть-1-создание-сети-и-настройка-основных-параметров-устройства)
- [Шаг 1-3](#шаг-1-3)
- [Шаг 4](#шаг-4)


## Часть 1:	Создание сети и настройка основных параметров устройства
### Шаг 1-3
---
Работа по сборке сети и настройке коммутаторов повторяет таковую в первой лабораторной, поэтому подробности опущены.

Итогм стала сеть, представленная в [начале работы](#развертывание-коммутируемой-сети-с-резервными-каналами)

### Шаг 4. Проверьте связь.
---
Проверка корректности настроек

Для S1
Для S2
Для S3 raweherhrehraherhhaerhahre;pthkt[pkh[sh
[ehej]]]

## Часть 2:	Определение корневого моста.

### Шаг 1-3 (Отключите все порты на коммутаторах. Настройте подключенные порты в качестве транковых. Включите порты F0/0 и F0/2 на всех коммутаторах)
---
Команды, введённые на данном этапе (для всех свичей):

```
S1(config)#int range e0/0-3, e1/0-3
S1(config-if-range)#shutdown
S1(config-if-range)#sw mode trunk
S1(config)
S1(config)
S1(config)#int range e0/0, e0/2
S1(config-if-range)#no shutdown
```

### Шаг 4:	Отобразите данные протокола spanning-tree.
---

Результат применения команды *show spanning tree*:

Для S1  
![](shSpanPart2S1.png)

Для S2  
![](shSpanPart2S2.png)

Для S3  
![](shSpanPart2S3.png)

Схема ролей и состояний активных портов коммутаторов в топологии:  
![](scheme.png)

**ВОПРОСЫ**

*A: Какой коммутатор является корневым мостом?*  
Q: Коммутатор S1.

*A: Почему этот коммутатор был выбран протоколом spanning-tree в качестве корневого моста?*  
Q: Потому что этот коммутатор имеет наименьший Bridge ID, а если точнее – burned-in MAC. Так как дополнительных настроек не производилось, то Bridge priority у всех равны (т.к. имеют одниковые значения, установленные по умолчанию). Кроме того, System ID Extension тоже одинаков – так как VLAN, для которого строится дерево, один и тот же. Следовательно, оцениваются значения system MAC, который меньше у первого коммутатора (так как в условиях эмуляции он самый «старый»). 
  
*A: Какие порты на коммутаторе являются корневыми портами?*  
Q: Те, у которых наиболее короткий и «дешёвый» путь до корневого коммутатора (грубо говоря, это «путь вверх по дереву»). Так как S1 – корневой мост, у него таких портов нет. На S2 это порт e0/0, на S3 это e0/2.

*A: Какие порты на коммутаторе являются назначенными портами?*   
Q: Те, которые имеют наилучший путь отправки данных, идущих к корневому мосту, или же порт, принимающий трафик из сегмента сети (грубо говоря, это «путь вниз по дереву»). Так как S1 корневой мост, то все его порты назначенные. На S2 это порт e0/2, на S3 таких нет.

*A: Какой порт отображается в качестве альтернативного и в настоящее время заблокирован?*  
Q: Порт e0/0 на S3.

*A: Почему протокол spanning-tree выбрал этот порт в качестве невыделенного (заблокированного) порта?*  
Q: Потому что этот порт имеет наибольший Bridge ID. При выборе из портов e0/2 на S2 и e0/0 на S3 происходило последовательное сравнение сначала стоимостей пути, которая оказалась одинаковой, т.к. скорость портов одинаковая, а референс один и тот же, т.к. назначен по умолчанию и не изменялся. Поэтому затем сравнивались Bridge ID коммутаторов-владельцев портов, и у S3 он оказался больше (т.к. в условиях эмуляции он самый «новый»), следовательно, он и стал заблокированным.

## Часть 3:	Наблюдение за процессом выбора протоколом STP порта, исходя из стоимости портов

### Шаг 1:	Определите коммутатор с заблокированным портом.
Для поиска была введена команда *show spanning tree*, в результате был найден нужный свич - S2.

### Шаг 2:	Измените стоимость root-порта этого коммутатора.

Команды, введённые на данном этапе:

```
S3(config)#int e0/2
S3(config-if)#spanning-tree cost 18
```

### Шаг 3:	Просмотрите изменения протокола spanning-tree.

Результат применения команды *show spanning tree*:

Для S2  
![](shSpanPart3S2.png)

Для S3  
![](shSpanPart3S3.png)